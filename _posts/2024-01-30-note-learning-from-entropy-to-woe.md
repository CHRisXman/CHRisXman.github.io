---
layout: post
title: "从熵、互信息到WOE与IV"
date: 2024-01-30
description: "从熵、互信息到WOE与IV"
tag: 学习笔记
category: 机器学习
---

### 1. 信息量与熵
- 信息量：一个事件的信息量就是其发生的 **概率的负对数**
- 熵描述事物的混乱程度（disorder）、不确定性（uncertainty）
	+ 高信息熵等价于高不确定性、高异质性
	+ 低信息熵等价于低不确定性、低异质性
- 假如一个事件有n个可能性，每个可能性相当，则出现任意一个可能性的概率为 $ 1 \over n$
	+ 其信息量为： $ -log({1\over n}) $
	+ 由于 $ -log $ 是减函数、$ 1\over n $ 在自然数域是减函数，所以信息量是关于 $n$ （即可能性）的增函数、关于 $1 \over n$ （即概率）的减函数
	+ 综上，可能性越多、概率越小，信息量越大
- 信息量满足 **可加性**
	+ 两个事件 x、y同时发生，其信息量 $$ h(x) + h(y) = -log(p(x)) - log(p(y)) = -log(p(x) \times p(y)) $$
	+ 由于 $p(x) \lt 1 $ 和 $p(y) \lt 1$，所以 $ p(x) \times p(y) \lt p(x), p(y) $ ，由信息量是关于概率的减函数知：$$ h(x) + h(y) > h(x), h(y) $$
- 由计算公式有以下性质：
	+ $ h(x) = -log(p(x)) \geq 0$，信息量一定是正数
	+ $ p(x) \uparrow  \rightarrow  {1\over {p(x)}} \downarrow \rightarrow h(x) \downarrow  $，一件事发生的概率越大、其信息量越低
- 一个变量所有可能取值的信息量，组成该变量的熵（不确定性）：$$ H(X) = \Sigma p(x)log{1\over p(x)}$$

### 2. 互信息
- 香农对互信息的定义：$MI(X, Y) = H(X) + H(Y) - H(X, Y)$

### 3. WOE
- WOE（Weight of Evidence）是一种用于特征变换的指标，常与IV值一起使用
- WOE将原始自变量转换为一组**连续**的数值，用于 **衡量自变量对目标变量的影响程度**
- 在 **逻辑回归模型** 和 **风险评分卡建模** 中，WOE常用于特征变换，将原始自变量转换为WOE值，然后根据WOE值进行IV值的计算
- WOE的计算方法是对自变量进行分组处理，然后计算每个分组中正样本和负样本的比例，然后计算每个分组的WOE值
- 计算公式：$ $ WOE_i = log({{p_{y_i}} \over {p_{n_i}}}) = log{f(X_i|Y=1) \over f(X_i|Y=0)} = log{{P(Y=1|X_i)\over{P(Y=1)}} \over {P(Y=0|X_i)\over{P(Y=0)}}}$ $
	+ $p_{y_i}$ 是第 $i$ 组中，正样本 占 所有正样本 的比例（可以理解为正样本召回率）
	+ $p_{n_i}$ 是第 $i$ 组中，负样本 占 所有负样本 的比例（可以理解为负样本召回率）
	+ 通过计算WOE值，可以将原始自变量转换为一组连续的数值，用于衡量自变量对目标变量的影响程度
- WOE的作用包括度量线性关系，进行分类变量和连续变量的比较
- 在风险评分卡建模中，WOE常用于 **特征变换**，将原始自变量转换为WOE值，然后根据WOE值进行IV值的计算。通过WOE和IV值的计算，可以量化自变量的预测能力，帮助在模型构建过程中进行变量筛选和评估

### 4. IV
- IV，即信息价值（Information Value），也称信息量
- 用来**衡量变量预测能力**的，IV值越大，表示该变量的预测能力越强
- 计算方式：$IV=\Sigma^n_{i=1} (p_{y_i} - p_{n_i}) \times WOE_i$
	+ $p_{y_i}$ 是第 $i$ 组中，正样本 占 所有正样本 的比例（可以理解为正样本召回率）
	+ $p_{n_i}$ 是第 $i$ 组中，负样本 占 所有负样本 的比例（可以理解为负样本召回率）
	+ $WOE_i$ 是第 $i$ 组的 WOE 值
	+ 通过计算每个分组的 $IV$ 值，然后对所有分组的 $IV$ 值进行累加，得到最终的 $IV$ 值
- IV值的用途包括 **衡量变量的预测能力**，帮助进行变量筛选和评估
- 在风险评分卡建模中，IV值常用于 **衡量特征的预测能力，帮助确定哪些变量进入模型**
- 在实际应用中，需要注意变量分组中 **不应出现正样本或负样本数为0的情况**，因为这会导致IV值的计算出现意义不明的情况。
	+ 针对这一问题，可以通过重新对变量进行分组或人工正样本数和负样本数来处理

### Reference
- [https://jiaxiangbu.github.io/learn_fe/woe_and_iv.html](https://jiaxiangbu.github.io/learn_fe/woe_and_iv.html)
